{% extends "base/base_template.html" %}

{% block title %}
Take Attendance
{% endblock title %}

{% block content %}


<form method="GET" class="mb-5">
    <select class="form-select bg-white" name="student_class" id="student_class" onchange="this.form.submit()">
        <option selected disabled>Choose Class</option>
        {% for i in student_classes %}
        <option {% if i.id == student_class %}selected{% endif %} value="{{ i.id }}">Class {{ i.number }}</option>
        {% endfor %}
    </select>
</form>

<!-- Date & Time Display -->
<p class="mt-3">
  <strong>Current Date:</strong> 
  <span id="currentDate" class="me-2"></span>
  <span id="runningTime" class="badge bg-primary"></span>
</p>

{% if student_class %}
<form method="POST" class="mt-5">
    {% csrf_token %}

    <div class="table-responsive">
        <table class="table">
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Roll</th>
                <th>Present</th>
            </tr>
            {% for student in students %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ student.name }}</td>
                <td>{{ student.roll_no }}</td>
                <td>
                    <input type="checkbox" checked name="present_{{ student.id }}">
                </td>
            </tr>
            {% endfor %}
        </table>
        </div>
    <button class="btn btn-primary" type="submit">Submit Attendance</button>
</form>
{% else %}
<div class="h-50 bg-black text-white fs-1 card oswald h-100 m-auto pt-5 text-center">Select a class.</div>
{% endif %}



<script>
    function updateDateTime() {
        const now = new Date();

        // Format time as HH:MM:SS
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        const currentTime = `${hours}:${minutes}:${seconds}`;
        document.getElementById('runningTime').textContent = currentTime;

        // Format date as DD-MM-YYYY
        const day = String(now.getDate()).padStart(2, '0');
        const month = String(now.getMonth() + 1).padStart(2, '0'); // Months are zero-based
        const year = now.getFullYear();
        const currentDate = `${day}-${month}-${year}`;
        document.getElementById('currentDate').textContent = currentDate;
    }

    // Run immediately and then every second
    updateDateTime();
    setInterval(updateDateTime, 1000);
</script>



{% endblock content %}